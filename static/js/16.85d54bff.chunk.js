(this["webpackJsonp@pumapay/pull-payments-ui"]=this["webpackJsonp@pumapay/pull-payments-ui"]||[]).push([[16],{346:function(n,e,t){"use strict";t.d(e,"a",(function(){return a})),t.d(e,"c",(function(){return d})),t.d(e,"b",(function(){return o})),t.d(e,"d",(function(){return s}));var i=t(23),l=t(19),c=t(13);function a(){var n=Object(l.b)().chainId,e=Object(i.d)((function(n){return n.my_billing_models}));if(!n)return[];var t=[],a=function(i){if(!e[n]||!e[n][i])return"continue";Object.keys(e[n][i]).map((function(l,c){t.push(e[n][i][l])}))};for(var d in c.d)a(d);return t}function d(n,e){var t=Object(l.b)().chainId,c=Object(i.d)((function(n){return n.my_billing_models}));return t&&c[t]&&c[t][n]&&c[t][n][e]?c[t][n][e]:null}function o(n,e,t){var c=Object(l.b)().chainId,a=Object(i.d)((function(n){return n.my_billing_models}));return c&&a[c]&&a[c][n]&&a[c][n][e]?a[c][n][e].subscriptions.find((function(n){return n.id===t})):null}function s(n,e){var t=Object(l.b)().chainId,c=Object(i.d)((function(n){return n.my_billing_models}));return t&&c[t]&&c[t][n]&&c[t][n][e]?c[t][n][e].subscriptions:[]}},390:function(n,e,t){"use strict";var i,l=t(4),c=t(7),a=t(99),d=t.n(a),o=t(314),s=t(1),r=c.default.div(i||(i=Object(l.a)(["\n  &:not(:last-child) {\n    border-right: 1px solid #ddd;\n  }\n\n  span.status {\n    display: inline-block;\n    width: 8px;\n    height: 8px;\n    background: #27ae60;\n    border-radius: 50%;\n  }\n  h3 {\n    margin: 0;\n    font-weight: 500;\n  }\n\n  padding: 5px 25px;\n  p {\n    font-size: 10px;\n    color: #959595;\n    margin: 0;\n  }\n  h2 {\n    font-size: 10px;\n    font-weight: 100;\n    display: flex;\n    align-items: center;\n    white-space: nowrap;\n  }\n"])));e.a=function(n){var e,t=n&&n.billingModelDetails?n.billingModelDetails:null,i=Object(o.a)()[null===(e=n.billingModelDetails)||void 0===e?void 0:e.token];return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"aside-total",style:{display:"flex"},children:[Object(s.jsxs)(r,{className:"total-earning",children:[Object(s.jsx)("h2",{children:"Billing Model Name"}),Object(s.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:Object(s.jsxs)("span",{children:[null===t||void 0===t?void 0:t.name,Number(null===t||void 0===t?void 0:t.creationTime)>0&&Object(s.jsxs)("p",{children:[Object(s.jsx)("span",{className:"status"})," Active since"," ",d()(1e3*Number(null===t||void 0===t?void 0:t.creationTime)).format("ll")]})]})})]}),Object(s.jsxs)(r,{className:"total-earning",children:[Object(s.jsx)("h2",{children:"Price, Currency"}),Object(s.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:Object(s.jsxs)("span",{children:[(null===i||void 0===i?void 0:i.decimals)?Number(null===t||void 0===t?void 0:t.amount)/Math.pow(10,i.decimals):"Loading..."," ",null===i||void 0===i?void 0:i.symbol]})})]}),Object(s.jsxs)(r,{className:"total-earning",children:[Object(s.jsx)("h2",{children:"Charged"}),Object(s.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:Object(s.jsx)("span",{children:Object(s.jsxs)("h3",{children:[(null===t||void 0===t?void 0:t.subscriptionIDs.length)>0&&(null===i||void 0===i?void 0:i.decimals)?Number(null===t||void 0===t?void 0:t.amount)/Math.pow(10,null===i||void 0===i?void 0:i.decimals)*(null===t||void 0===t?void 0:t.totalPayments):"0"," ",null===i||void 0===i?void 0:i.symbol,Object(s.jsx)("span",{className:"small"})]})})})]})]})})}},749:function(n,e,t){"use strict";t.r(e);var i,l,c,a=t(26),d=t(4),o=t(0),s=t(91),r=t(7),b=t(99),u=t.n(b),p=t(13),j=t(314),m=t(124),h=t(392),x=t(19),v=t(38),f=t(1),O=r.default.div(i||(i=Object(d.a)(["\n   {\n    .details-wrapper {\n      margin-top: 1rem;\n    }\n  }\n"]))),g=function(n){var e,t,i=n.bmSubscription,l=n.billingModel,c=n.billingModelType,a=Object(x.b)().account,d=Object(v.h)().pathname,o=Object(j.a)(),s=function(n,e){return u()(1e3*n).format(e||"lll")};return Object(f.jsx)(O,{children:Object(f.jsxs)("div",{className:"subscription-wrapper",children:[Object(f.jsx)("h3",{style:{fontWeight:400},children:"Subscription"}),Object(f.jsxs)("div",{className:"bg-back",children:[Object(f.jsx)("p",{style:{marginBottom:0,fontSize:12,fontWeight:100},children:"Wallet"}),Object(f.jsxs)("h5",{style:{marginTop:0,display:"flex",alignItems:"center"},children:[null===i||void 0===i?void 0:i.subscriber," ",Object(f.jsx)(m.a,{wallet:null===i||void 0===i?void 0:i.subscriber})]}),Object(f.jsxs)("div",{className:"details-wrapper",children:[Number(null===i||void 0===i?void 0:i.startTimestamp)>0&&Object(f.jsxs)("div",{className:"items",children:[Object(f.jsx)("p",{children:"Subscription Since"}),Object(f.jsx)("p",{style:{fontSize:"0.9rem"},children:s(null===i||void 0===i?void 0:i.startTimestamp)})]}),Number(null===i||void 0===i?void 0:i.lastPaymentTimestamp)>0&&Object(f.jsxs)("div",{className:"items",children:[Object(f.jsx)("p",{children:"Last Payment"}),Object(f.jsx)("p",{style:{fontSize:"0.9rem"},children:s(null===i||void 0===i?void 0:i.lastPaymentTimestamp)})]}),Number(null===i||void 0===i?void 0:i.nextPaymentTimestamp)>0&&Object(f.jsxs)("div",{className:"items",children:[Object(f.jsx)("p",{children:"Next Payment"}),Object(f.jsx)("p",{style:{fontSize:"0.9rem"},children:s(null===i||void 0===i?void 0:i.nextPaymentTimestamp)})]}),Number(null===i||void 0===i?void 0:i.cancelTimestamp)>0&&Object(f.jsxs)("div",{className:"items",children:[Object(f.jsxs)("p",{children:["Cancelled by"," ",Object(f.jsx)("span",{style:{fontSize:"0.7rem"},children:i.cancelledBy===a&&d.includes("customer")||i.cancelledBy!==a&&d.includes("merchant")?"Customer":"Merchant"})," ","At"]}),Object(f.jsx)("p",{style:{fontSize:"0.9rem"},children:s(null===i||void 0===i?void 0:i.cancelTimestamp)})]})]}),Object(f.jsxs)("div",{className:"details-wrapper",children:[Object(f.jsxs)("div",{className:"items",children:[Object(f.jsx)("p",{children:"Payments"}),Object(f.jsx)("h6",{children:c===p.d.Single||c===p.d.SingleDynamic?"Single Payment":c===p.d.RecurringDynamic?"".concat(Number(null===i||void 0===i?void 0:i.pullPaymentIDs.length)," / ").concat(Number(null===i||void 0===i?void 0:i.totalPayments)):"".concat(i?(null===l||void 0===l?void 0:l.numberOfPayments)-(null===i||void 0===i?void 0:i.numberOfPayments):0,"/").concat(null===l||void 0===l?void 0:l.numberOfPayments)})]}),Object(f.jsxs)("div",{className:"items",children:[Object(f.jsx)("p",{children:"Total Charged"}),Object(f.jsxs)("h6",{style:{marginBottom:0},children:[Object(h.b)(i,l,c)/Math.pow(10,Number(null===o||void 0===o||null===(e=o[null===l||void 0===l?void 0:l.token])||void 0===e?void 0:e.decimals)),"\xa0",Object(f.jsx)("span",{className:"small",children:null===(t=o[null===l||void 0===l?void 0:l.token])||void 0===t?void 0:t.symbol})]})]}),Object(f.jsx)("div",{className:"items"})]})]})]})})},y=t(215),w=t(155),k=t(52),S=t(390),N=t(346),T=t(81),P=t(35),C=r.default.div(l||(l=Object(d.a)(["\n  display: flex;\n  align-items: center;\n  h3 {\n    font-weight: 400;\n    width: 30%;\n  }\n  .new-billing-model {\n    font-size: 14px;\n    button {\n      padding: 0px;\n      border-radius: 50%;\n      width: 35px;\n      height: 35px;\n      border: 0;\n      background: #7023ff;\n      color: #fff;\n      font-size: 26px;\n      line-height: 35px;\n      margin-left: 10px;\n      cursor: pointer;\n      :hover {\n        background: #9e70f5;\n      }\n    }\n  }\n"]))),I=r.default.table(c||(c=Object(d.a)(["\n  .empty-table-row {\n    text-align: center;\n    font-size: 1rem;\n    line-height: 2rem;\n  }\n  margin-bottom: 100px;\n  border-collapse: collapse;\n  border-spacing: none;\n  width: 100%;\n  border: 1px solid #ddd;\n  caption-side: bottom;\n  empty-cell: show | hide;\n  empty-cell is a property of table or the cells themselves\n\n\tvertical-align: baseline | sub | super | text-top |\n\ttext-bottom | middle | top | bottom |\n\t<percentage> | <length>\n\n   tbody {\n    vertical-align: top;\n  }\n  td,\n  th {\n    border: 1px solid #ccc;\n  }\n  thead tr th:nth-child(3) {\n    width: 20%;\n  }\n\n  thead tr th:nth-child(7) {\n    width: 10%;\n  }\n  td:nth-child(3) {\n    color: #7023ff;\n  }\n  td {\n    padding: 10px 10px;\n    font-size: 12px;\n    border: 1px solid #eae8ee;\n    color: #756f82;\n    :first-child {\n      border-left: none;\n    }\n    :last-child {\n      border-right: none;\n    }\n  }\n  th {\n    padding: 10px 10px;\n    font-size: 12px;\n    border: 1px solid #eae8ee;\n    text-align: left;\n    font-weight: normal;\n    :first-child {\n      border-left: none;\n    }\n    :last-child {\n      border-right: none;\n    }\n  }\n  tbody {\n    position: relative;\n  }\n\n  tbody tr {\n    background-color: #fff;\n    :hover {\n      background-color: #f7f6f9;\n    }\n  }\n  thead > tr {\n    background-color: #f7f6f9;\n  }\n  small {\n    padding: 7px;\n    border-radius: 7px;\n  }\n  small.SUCCESS {\n    color: #00996d;\n    background: #e5fff8;\n  }\n  small.PENDING {\n    color: #b28824;\n    background: #fff7e5;\n  }\n  small.REJECTED {\n    color: #ff647c;\n    background: #ffe5e9;\n  }\n  tbody > span {\n    position: absolute;\n    left: 48%;\n    top: 22px;\n  }\n  .loader-main {\n    position: absolute;\n    margin: 1rem auto;\n    left: 50%;\n  }\n"]))),M=["No.","Date","Transaction ID","Amount Paid","Execution Fee","Amount Received","Status"],z=function(n){var e,t=n.pullPaymentTxs,i=n.sellingToken,l=n.paymentToken,c=Object(x.b)().chainId;return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{children:[Object(f.jsx)(C,{className:"table-top",children:Object(f.jsx)("h3",{children:"Payments"})}),Object(f.jsxs)(I,{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:Object(f.jsx)("input",{type:"checkbox",value:"select"})}),M.map((function(n,e){return Object(f.jsx)("th",{children:n},e)}))]})}),Object(f.jsx)("tbody",{children:void 0===t||null===t?Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:12,children:Object(f.jsx)("div",{children:Object(f.jsx)(T.a,{className:"loader-main",size:"3rem"})})})}):Object.keys(t).length>0?null===(e=Object.keys(t))||void 0===e?void 0:e.map((function(n,e){var a,d,o,s,r,b,j,m,h,x;return Object(f.jsxs)("tr",{children:[Object(f.jsxs)("td",{children:[" ",Object(f.jsx)("input",{type:"checkbox",value:"select"})," "]}),Object(f.jsx)("td",{children:Object(f.jsx)("span",{className:"model-target",children:null===(d=t[n])||void 0===d?void 0:d.pullPaymentId})}),Object(f.jsx)("td",{children:u()(1e3*t[n].executionTimestamp).format("lll")}),Object(f.jsx)("td",{children:Object(f.jsx)(P.a,{href:Object(p.p)(c,null===(o=t[n])||void 0===o?void 0:o.transactionHash,"transaction"),style:{fontSize:"14px"},children:Object(p.x)(null===(s=t[n])||void 0===s?void 0:s.transactionHash)})}),Object(f.jsxs)("td",{children:["~",Object(p.k)("undefined"===(null===(r=t[n])||void 0===r?void 0:r.amountPaid)?0:null===(b=t[n])||void 0===b?void 0:b.amountPaid,null===l||void 0===l?void 0:l.decimals),"\xa0 ",null===l||void 0===l?void 0:l.symbol]}),Object(f.jsxs)("td",{children:["~",Object(p.k)("undefined"===(null===(j=t[n])||void 0===j?void 0:j.executionFee)?0:null===(m=t[n])||void 0===m?void 0:m.executionFee,null===l||void 0===l?void 0:l.decimals),"\xa0",null===l||void 0===l?void 0:l.symbol]}),Object(f.jsxs)("td",{children:["~",Object(p.k)("undefined"===(null===(h=t[n])||void 0===h?void 0:h.amountReceived)?0:null===(x=t[n])||void 0===x?void 0:x.amountReceived,null===i||void 0===i?void 0:i.decimals),"\xa0",null===i||void 0===i?void 0:i.symbol]}),Object(f.jsx)("td",{children:Object(f.jsx)("small",{className:"SUCCESS",children:"SUCCESS"})})]},null===(a=t[n])||void 0===a?void 0:a.transactionHash)})):Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:12,children:Object(f.jsx)("div",{className:"empty-table-row",children:Object(f.jsx)("span",{children:"No payments"})})})})})]})]})})},D=function(n){var e=n.pullPaymentTxs,t=n.bmSubscription,i=Object(j.a)();return Object(f.jsx)(z,{pullPaymentTxs:e,sellingToken:i[null===t||void 0===t?void 0:t.settlementToken],paymentToken:i[null===t||void 0===t?void 0:t.paymentToken]})},_=t(46),F=t(112),E=t(23);var R,A,B=t(29),L=t(98),H=t(485),U=r.default.div(R||(R=Object(d.a)(["\n  color: #000;\n  &.open {\n    padding-left: 220px;\n    padding-right: 2rem;\n  }\n  .table-top {\n    margin-top: 30px;\n  }\n  .subscription-wrapper {\n    .btn-wrap .align-btn {\n      display: flex;\n      align-items: center;\n\n      button.btn-theme-outlined {\n        background: #fff;\n        border: 1px solid #b2acbf;\n        padding: 9px 25px;\n        border-radius: 6px;\n        font-size: 12px;\n        min-width: 97px;\n      }\n    }\n\n    .btn-wrap {\n      margin-top: 20px;\n      .align-btn button {\n        margin-right: 5px;\n      }\n    }\n\n    h3,\n    h4,\n    h5 {\n      font-weight: 500;\n    }\n    .bg-back {\n      background: #f8f5ff;\n      padding: 10px 20px;\n    }\n\n    .bg-back .details-wrapper {\n      display: flex;\n    }\n\n    .bg-back .details-wrapper .items {\n      width: 160px;\n    }\n\n    .bg-back .details-wrapper .items p {\n      margin-bottom: 0;\n      font-size: 12px;\n      color: #444;\n    }\n\n    .bg-back .details-wrapper .items h5,\n    .bg-back .details-wrapper .items h3 {\n      margin-top: 5px;\n    }\n  }\n\n  .pagination {\n    display: flex;\n    justify-content: flex-end;\n    margin-top: 20px;\n    select {\n      border: none;\n    }\n    .navigation {\n      display: flex;\n      p {\n        background: #ededed;\n        border-radius: 5px;\n        padding: 8px 14px;\n        margin: 0 5px;\n      }\n    }\n  }\n  display: flex;\n  width: 100%;\n  flex-direction: column;\n  padding-left: 100px;\n\n  .top-wrap {\n    margin-top: 20px;\n    display: flex;\n    justify-content: space-between;\n    > div:first-child {\n      width: 35%;\n    }\n  }\n"]))),J=r.default.a(A||(A=Object(d.a)(["\n  &:hover {\n    .sidebar-text {\n      color: #7023FF;\n    }\n    .default {\n      display: none;\n    }\n    .focus {\n      display: inline;\n    }\n  }\n  display: flex;\n  font-size: 13px;\n  margin: auto 0;\n  text-decoration: none;\n  .focus {\n    display: none;\n  }\n  img {\n    margin-right: 10px;\n  }\n}"])));e.default=function(){var n=Object(o.useContext)(w.a),e=Object(x.b)().chainId,t=Object(E.c)(),i=Object(v.h)(),l=new URLSearchParams(null===i||void 0===i?void 0:i.search),c=l.get("billing-model-type"),d=l.get("billing-model-id"),r=l.get("subscription-id"),b=Object(N.c)(p.d[c],d),u=Object(N.b)(p.d[c],d,r),j=function(n,e,t){var i=Object(x.b)().chainId,l=Object(E.d)((function(n){return n.pull_payment_txs}));return i&&l[i]?l[i]["".concat(n,"_").concat(e,"_").concat(t)]?l[i]["".concat(n,"_").concat(e,"_").concat(t)]:{}:null}(p.d[c],d,r),m=Object(B.k)(),h=Object(B.j)(),O=Object(B.i)(),T=Object(B.d)(),P=Object(B.f)(),C=Object(B.h)();switch(String(p.d[c])){case String(p.d.Single):m;break;case String(p.d.SingleDynamic):h;break;case String(p.d.Recurring):O;break;case String(p.d.RecurringDynamic):T;break;case String(p.d.RecurringFreeTrial):P;break;case String(p.d.RecurringPaidTrial):C;break;default:console.warn("Unsupported Billing Model Type - ".concat(c))}Object(o.useEffect)((function(){var n;(!j||j&&Object.keys(j).length!==(null===u||void 0===u||null===(n=u.pullPaymentIDs)||void 0===n?void 0:n.length))&&function(n,e,t,i,l){var c=Object(p.e)(n,e);fetch("".concat("https://stgp3api.pumapay.io","/pull-payment-txs/").concat(n,"/").concat(c,"/").concat(t,"/").concat(i),{method:"GET"}).then((function(n){return n.json()})).then((function(c){var a,d=Object(_.a)(c.data);try{for(d.s();!(a=d.n()).done;){var o=a.value,s={transactionHash:o.transactionHash,pullPaymentId:o.pullPaymentId,executionTimestamp:o.executionTimestamp,executionFee:o.executionFeeAmount,amountReceived:o.receivingAmount,amountPaid:o.paymentAmount};l(Object(F.a)({chainId:n,billingModelType:e,billingModelId:t,bmSubscriptionId:i,pullPaymentTx:s}))}}catch(r){d.e(r)}finally{d.f()}})).catch((function(n){return console.error(n)}))}(e,p.d[c],d,r,t)}),[]);var I=Object(o.useState)(!1),M=Object(a.a)(I,2),z=M[0],R=M[1],A=Object(o.useState)(null),W=Object(a.a)(A,2),G=W[0],q=W[1],K=Object(o.useState)(null),Q=Object(a.a)(K,2),V=Q[0],X=Q[1],Y=Object(o.useState)(!1),Z=Object(a.a)(Y,2),$=Z[0],nn=Z[1];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)(U,{className:n?"SubscriptionModel open":"SubscriptionModel",children:[Object(f.jsxs)("div",{className:"top-wrap",children:[Object(f.jsx)(s.a,{gap:"lg",justify:"flex-start",children:Object(f.jsxs)(J,{style:{color:"#756F82",marginBottom:"1rem"},as:k.b,to:"/merchant/billing-model-details?billing-model-type=".concat(c,"&billing-model-id=").concat(d),children:[" ",Object(f.jsx)("img",{src:y.default,alt:"arrow"})," Back to Customers"]})}),!Object(p.t)(p.d[c])&&Object(f.jsx)(S.a,{billingModelDetails:b})]}),Object(f.jsx)(g,{bmSubscription:u,billingModel:b,billingModelType:c}),Object(f.jsx)(s.a,{gap:"lg",justify:"flex-start",style:{marginTop:"1rem"},children:Object(f.jsx)("div",{style:{width:"10%"},children:Object(f.jsx)(L.a,{onClick:function(){!function(n,e){q(n),X(e),R(!0)}(u.id,c)},children:"CANCEL"})})}),Object(f.jsx)(D,{pullPaymentTxs:j,bmSubscription:u}),Object(f.jsx)(H.a,{cancelSubscriptionId:G,billingModelType:V,showCancelModal:z,setShowCancelModal:R,isLoading:$,setIsLoading:nn})]})})}}}]);
//# sourceMappingURL=16.85d54bff.chunk.js.map